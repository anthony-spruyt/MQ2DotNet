using MQ2DotNet.MQ2API.DataTypes;
using System;
using System.Collections.Generic;
using System.Linq;

namespace MQFlux.Extensions
{
    /// <summary>
    /// https://www.redguides.com/wiki/SPA_list
    /// </summary>
    public enum SpellAffect : uint
    {
        HP = 0u,
        AC,
        ATTACK_POWER,
        MOVEMENT_RATE,
        STR,
        DEX,
        AGI,
        STA,
        INT,
        WIS,
        CHA,
        HASTE,// "Melee Speed"
        INVISIBILITY,
        SEE_INVIS,
        ENDURING_BREATH,
        MANA,
        NPC_FRENZY,
        NPC_AWARENESS,
        NPC_AGGRO,
        NPC_FACTION,
        BLINDNESS,
        STUN,
        CHARM,
        FEAR,
        FATIGUE,
        BIND_AFFINITY,
        GATE,
        DISPEL_MAGIC,
        INVIS_VS_UNDEAD,
        INVIS_VS_ANIMALS,
        NPC_AGGRO_RADIUS,
        ENTHRALL,
        CREATE_ITEM,
        SUMMON_PET,
        CONFUSE,
        DISEASE,
        POISON,
        DETECT_HOSTILE,
        DETECT_MAGIC,
        NO_TWINCAST,
        INVULNERABILITY,
        BANISH,
        SHADOW_STEP,
        BERSERK,
        LYCANTHROPY,
        VAMPIRISM,
        RESIST_FIRE,
        RESIST_COLD,
        RESIST_POISON,
        RESIST_DISEASE,
        RESIST_MAGIC,
        DETECT_TRAPS,
        DETECT_UNDEAD,
        DETECT_SUMMONED,
        DETECT_ANIMALS,
        STONESKIN,
        TRUE_NORTH,
        LEVITATION,
        CHANGE_FORM,
        DAMAGE_SHIELD,
        TRANSFER_ITEM,
        ITEM_LORE,
        ITEM_IDENTIFY,
        NPC_WIPE_HATE_LIST,
        SPIN_STUN,
        INFRAVISION,
        ULTRAVISION,
        EYE_OF_ZOMM,
        RECLAIM_ENERGY,
        MAX_HP,
        CORPSE_BOMB,
        CREATE_UNDEAD,
        PRESERVE_CORPSE,
        BIND_SIGHT,
        FEIGN_DEATH,
        VENTRILOQUISM,
        SENTINEL,
        LOCATE_CORPSE,
        SPELL_SHIELD,
        INSTANT_HP,
        ENCHANT_LIGHT,
        RESURRECT,
        SUMMON_TARGET,
        PORTAL,
        HP_NPC_ONLY,
        MELEE_PROC,
        NPC_HELP_RADIUS,
        MAGNIFICATION,
        EVACUATE,
        HEIGHT,
        IGNORE_PET,
        SUMMON_CORPSE,
        HATE,
        WEATHER_CONTROL,
        FRAGILE,
        SACRIFICE,
        SILENCE,
        MAX_MANA,
        BARD_HASTE,
        ROOT,
        HEALDOT,
        COMPLETEHEAL,
        PET_FEARLESS,
        CALL_PET,
        TRANSLOCATE,
        NPC_ANTI_GATE,
        BEASTLORD_PET,
        ALTER_PET_LEVEL,
        FAMILIAR,
        CREATE_ITEM_IN_BAG,
        ARCHERY,
        RESIST_ALL,
        FIZZLE_SKILL,
        SUMMON_MOUNT,
        MODIFY_HATE,
        CORNUCOPIA,
        CURSE,
        HIT_MAGIC,
        AMPLIFICATION,
        ATTACK_SPEED_MAX,
        HEALMOD,
        IRONMAIDEN,
        REDUCESKILL,
        IMMUNITY,
        FOCUS_DAMAGE_MOD,
        FOCUS_HEAL_MOD,
        FOCUS_RESIST_MOD,
        FOCUS_CAST_TIME_MOD,
        FOCUS_DURATION_MOD,
        FOCUS_RANGE_MOD,
        FOCUS_HATE_MOD,
        FOCUS_REAGENT_MOD,
        FOCUS_MANACOST_MOD,
        FOCUS_STUNTIME_MOD,
        FOCUS_LEVEL_MAX,
        FOCUS_RESIST_TYPE,
        FOCUS_TARGET_TYPE,
        FOCUS_WHICH_SPA,
        FOCUS_BENEFICIAL,
        FOCUS_WHICH_SPELL,
        FOCUS_DURATION_MIN,
        FOCUS_INSTANT_ONLY,
        FOCUS_LEVEL_MIN,
        FOCUS_CASTTIME_MIN,
        FOCUS_CASTTIME_MAX,
        NPC_PORTAL_WARDER_BANISH,
        PORTAL_LOCATIONS,
        PERCENT_HEAL,
        STACKING_BLOCK,
        STRIP_VIRTUAL_SLOT,
        DIVINE_INTERVENTION,
        POCKET_PET,
        PET_SWARM,
        HEALTH_BALANCE,
        CANCEL_NEGATIVE_MAGIC,
        POP_RESURRECT,
        MIRROR,
        FEEDBACK,
        REFLECT,
        MODIFY_ALL_STATS,
        CHANGE_SOBRIETY,
        SPELL_GUARD,
        MELEE_GUARD,
        ABSORB_HIT,
        OBJECT_SENSE_TRAP,
        OBJECT_DISARM_TRAP,
        OBJECT_PICKLOCK,
        FOCUS_PET,
        DEFENSIVE,
        CRITICAL_MELEE,
        CRITICAL_SPELL,
        CRIPPLING_BLOW,
        EVASION,
        RIPOSTE,
        DODGE,
        PARRY,
        DUAL_WIELD,
        DOUBLE_ATTACK,
        MELEE_LIFETAP,
        PURETONE,
        SANCTIFICATION,
        FEARLESS,
        HUNDRED_HANDS,
        SKILL_INCREASE_CHANCE,// Unused
        ACCURACY,
        SKILL_DAMAGE_MOD,
        MIN_DAMAGE_DONE_MOD,
        MANA_BALANCE,
        BLOCK,
        ENDURANCE,
        INCREASE_MAX_ENDURANCE,
        AMNESIA,
        HATE_OVER_TIME,
        SKILL_ATTACK,
        FADE,
        STUN_RESIST,
        STRIKETHROUGH1,// Deprecated
        SKILL_DAMAGE_TAKEN,
        INSTANT_ENDURANCE,
        TAUNT,
        PROC_CHANCE,
        RANGE_ABILITY,
        ILLUSION_OTHERS,
        MASS_GROUP_BUFF,
        GROUP_FEAR_IMMUNITY,
        RAMPAGE,
        AE_TAUNT,
        FLESH_TO_BONE,
        PURGE_POISON,
        CANCEL_BENEFICIAL,
        SHIELD_CASTER,
        DESTRUCTIVE_FORCE,
        FOCUS_FRENZIED_DEVASTATION,
        PET_PCT_MAX_HP,
        HP_MAX_HP,
        PET_PCT_AVOIDANCE,
        MELEE_ACCURACY,
        HEADSHOT,
        PET_CRIT_MELEE,
        SLAY_UNDEAD,
        INCREASE_SKILL_DAMAGE,
        REDUCE_WEIGHT,
        BLOCK_BEHIND,
        DOUBLE_RIPOSTE,
        ADD_RIPOSTE,
        GIVE_DOUBLE_ATTACK,
        TWOHANDED_BASH,
        REDUCE_SKILL_TIMER,
        ACROBATICS,
        CAST_THROUGH_STUN,
        EXTENDED_SHIELDING,
        BASH_CHANCE,
        DIVINE_SAVE,
        METABOLISM,
        POISON_MASTERY,
        FOCUS_CHANNELING,
        FREE_PET,
        PET_AFFINITY,
        PERM_ILLUSION,
        STONEWALL,
        STRING_UNBREAKABLE,
        IMPROVE_RECLAIM_ENERGY,
        INCREASE_CHANGE_MEMWIPE,
        ENHANCED_CHARM,
        ENHANCED_ROOT,
        TRAP_CIRCUMVENTION,
        INCREASE_AIR_SUPPLY,
        INCREASE_MAX_SKILL,
        EXTRA_SPECIALIZATION,
        OFFHAND_MIN_WEAPON_DAMAGE,
        INCREASE_PROC_CHANCE,
        ENDLESS_QUIVER,
        BACKSTAB_FRONT,
        CHAOTIC_STAB,
        NOSPELL,
        SHIELDING_DURATION_MOD,
        SHROUD_OF_STEALTH,
        GIVE_PET_HOLD,// Deprecated
        TRIPLE_BACKSTAB,
        AC_LIMIT_MOD,
        ADD_INSTRUMENT_MOD,
        SONG_MOD_CAP,
        INCREASE_STAT_CAP,
        TRADESKILL_MASTERY,
        REDUCE_AA_TIMER,
        NO_FIZZLE,
        ADD_2H_ATTACK_CHANCE,
        ADD_PET_COMMANDS,
        ALCHEMY_FAIL_RATE,
        FIRST_AID,
        EXTEND_SONG_RANGE,
        BASE_RUN_MOD,
        INCREASE_CASTING_LEVEL,
        DOTCRIT,
        HEALCRIT,
        MENDCRIT,
        DUAL_WIELD_AMT,
        EXTRA_DI_CHANCE,
        FINISHING_BLOW,
        FLURRY,
        PET_FLURRY,
        PET_FEIGN,
        INCREASE_BANDAGE_AMT,
        WU_ATTACK,
        IMPROVE_LOH,
        NIMBLE_EVASION,
        FOCUS_DAMAGE_AMT,
        FOCUS_DURATION_AMT,
        ADD_PROC_HIT,
        DOOM_EFFECT,
        INCREASE_RUN_SPEED_CAP,
        PURIFY,
        STRIKETHROUGH,
        STUN_RESIST2,
        SPELL_CRIT_CHANCE,
        REDUCE_SPECIAL_TIMER,
        FOCUS_DAMAGE_MOD_DETRIMENTAL,
        FOCUS_DAMAGE_AMT_DETRIMENTAL,
        TINY_COMPANION,
        WAKE_DEAD,
        DOPPELGANGER,
        INCREASE_RANGE_DMG,
        FOCUS_DAMAGE_MOD_CRIT,
        FOCUS_DAMAGE_AMT_CRIT,
        SECONDARY_RIPOSTE_MOD,
        DAMAGE_SHIELD_MOD,
        WEAK_DEAD_2,
        APPRAISAL,
        ZONE_SUSPEND_MINION,
        TELEPORT_CASTERS_BINDPOINT,
        FOCUS_REUSE_TIMER,
        FOCUS_COMBAT_SKILL,
        OBSERVER,
        FORAGE_MASTER,
        IMPROVED_INVIS,
        IMPROVED_INVIS_UNDEAD,
        IMPROVED_INVIS_ANIMALS,
        INCREASE_WORN_HP_REGEN_CAP,
        INCREASE_WORN_MANA_REGEN_CAP,
        CRITICAL_HP_REGEN,
        SHIELD_BLOCK_CHANCE,
        REDUCE_TARGET_HATE,
        GATE_STARTING_CITY,
        DEFENSIVE_PROC,
        HP_FOR_MANA,
        NO_BREAK_AE_SNEAK,
        ADD_SPELL_SLOTS,
        ADD_BUFF_SLOTS,
        INCREASE_NEGATIVE_HP_LIMIT,
        MANA_ABSORB_PCT_DMG,
        CRIT_ATTACK_MODIFIER,
        FAIL_ALCHEMY_ITEM_RECOVERY,
        SUMMON_TO_CORPSE,
        DOOM_RUNE_EFFECT,
        NO_MOVE_HP,
        FOCUSED_IMMUNITY,
        ILLUSIONARY_TARGET,
        INCREASE_EXP_MOD,
        EXPEDIENT_RECOVERY,
        FOCUS_CASTING_PROC,
        CHANCE_SPELL,
        WORN_ATTACK_CAP,
        NO_PANIC,
        SPELL_INTERRUPT,
        ITEM_CHANNELING,
        ASSASSINATE_MAX_LEVEL,
        HEADSHOT_MAX_LEVEL,
        DOUBLE_RANGED_ATTACK,
        FOCUS_MANA_MIN,
        INCREASE_SHIELD_DMG,
        MANABURN,
        SPAWN_INTERACTIVE_OBJECT,
        INCREASE_TRAP_COUNT,
        INCREASE_SOI_COUNT,
        DEACTIVATE_ALL_TRAPS,
        LEARN_TRAP,
        CHANGE_TRIGGER_TYPE,
        FOCUS_MUTE,
        INSTANT_MANA,
        PASSIVE_SENSE_TRAP,
        PROC_ON_KILL_SHOT,
        PROC_ON_DEATH,
        POTION_BELT,
        BANDOLIER,
        ADD_TRIPLE_ATTACK_CHANCE,
        PROC_ON_SPELL_KILL_SHOT,
        GROUP_SHIELDING,
        MODIFY_BODY_TYPE,
        MODIFY_FACTION,
        CORRUPTION,
        RESIST_CORRUPTION,
        SLOW,
        GRANT_FORAGING,
        DOOM_ALWAYS,
        TRIGGER_SPELL,
        CRIT_DOT_DMG_MOD,
        FLING,
        DOOM_ENTITY,
        RESIST_OTHER_SPA,
        DIRECTIONAL_TELEPORT,
        EXPLOSIVE_KNOCKBACK,
        FLING_TOWARD,
        SUPPRESSION,
        FOCUS_CASTING_PROC_NORMALIZED,
        FLING_AT,
        FOCUS_WHICH_GROUP,
        DOOM_DISPELLER,
        DOOM_DISPELLEE,
        SUMMON_ALL_CORPSES,
        REFRESH_SPELL_TIMER,
        LOCKOUT_SPELL_TIMER,
        FOCUS_MANA_MAX,
        FOCUS_HEAL_AMT,
        FOCUS_HEAL_MOD_BENEFICIAL,
        FOCUS_HEAL_AMT_BENEFICIAL,
        FOCUS_HEAL_MOD_CRIT,
        FOCUS_HEAL_AMT_CRIT,
        ADD_PET_AC,
        FOCUS_SWARM_PET_DURATION,
        FOCUS_TWINCAST_CHANCE,
        HEALBURN,
        MANA_IGNITE,
        ENDURANCE_IGNITE,
        FOCUS_SPELL_CLASS,
        FOCUS_SPELL_SUBCLASS,
        STAFF_BLOCK_CHANCE,
        DOOM_LIMIT_USE,
        DOOM_FOCUS_USED,
        LIMIT_HP,
        LIMIT_MANA,
        LIMIT_ENDURANCE,
        FOCUS_LIMIT_CLASS,
        FOCUS_LIMIT_RACE,
        FOCUS_BASE_EFFECTS,
        FOCUS_LIMIT_SKILL,
        FOCUS_LIMIT_ITEM_CLASS,
        AC2,
        MANA2,
        FOCUS_INCREASE_SKILL_DMG_2,
        PROC_EFFECT_2,
        FOCUS_LIMIT_USE,
        FOCUS_LIMIT_USE_AMT,
        FOCUS_LIMIT_USE_MIN,
        FOCUS_LIMIT_USE_TYPE,
        GRAVITATE,
        FLY,
        ADD_EXTENDED_TARGET_SLOTS,
        SKILL_PROC,
        PROC_SKILL_MODIFIER,
        SKILL_PROC_SUCCESS,
        POST_EFFECT,
        POST_EFFECT_DATA,
        EXPAND_MAX_ACTIVE_TROPHY_BENEFITS,
        ADD_NORMALIZED_SKILL_MIN_DMG_AMT,
        ADD_NORMALIZED_SKILL_MIN_DMG_AMT_2,
        FRAGILE_DEFENSE,
        FREEZE_BUFF_TIMER,
        TELEPORT_TO_ANCHOR,
        TRANSLOCATE_TO_ANCHOR,
        ASSASSINATE,
        FINISHING_BLOW_MAX,
        DISTANCE_REMOVAL,
        REQUIRE_TARGET_DOOM,
        REQUIRE_CASTER_DOOM,
        IMPROVED_TAUNT,
        ADD_MERC_SLOT,
        STACKER_A,
        STACKER_B,
        STACKER_C,
        STACKER_D,
        DOT_GUARD,
        MELEE_THRESHOLD_GUARD,
        SPELL_THRESHOLD_GUARD,
        MELEE_THRESHOLD_DOOM,
        SPELL_THRESHOLD_DOOM,
        ADD_HATE_PCT,
        ADD_HATE_OVER_TIME_PCT,
        RESOURCE_TAP,
        FACTION_MOD,
        SKILL_DAMAGE_MOD_2,
        OVERRIDE_NOT_FOCUSABLE,
        FOCUS_DAMAGE_MOD_2,
        FOCUS_DAMAGE_AMT_2,
        SHIELD,
        PC_PET_RAMPAGE,
        PC_PET_AE_RAMPAGE,
        PC_PET_FLURRY,
        DAMAGE_SHIELD_MITIGATION_AMT,
        DAMAGE_SHIELD_MITIGATION_PCT,
        CHANCE_BEST_IN_SPELL_GROUP,
        TRIGGER_BEST_IN_SPELL_GROUP,
        DOUBLE_MELEE_ATTACKS,
        AA_BUY_NEXT_RANK,
        DOUBLE_BACKSTAB_FRONT,
        PET_MELEE_CRIT_DMG_MOD,
        TRIGGER_SPELL_NON_ITEM,
        WEAPON_STANCE,
        HATELIST_TO_TOP,
        HATELIST_TO_TAIL,
        FOCUS_LIMIT_MIN_VALUE,
        FOCUS_LIMIT_MAX_VALUE,
        FOCUS_CAST_SPELL_ON_LAND,
        SKILL_BASE_DAMAGE_MOD,
        FOCUS_INCOMING_DMG_MOD,
        FOCUS_INCOMING_DMG_AMT,
        FOCUS_LIMIT_CASTER_CLASS,
        FOCUS_LIMIT_SAME_CASTER,
        EXTEND_TRADESKILL_CAP,
        DEFENDER_MELEE_FORCE_PCT,
        WORN_ENDURANCE_REGEN_CAP,
        FOCUS_MIN_REUSE_TIME,
        FOCUS_MAX_REUSE_TIME,
        FOCUS_ENDURANCE_MIN,
        FOCUS_ENDURANCE_MAX,
        PET_ADD_ATK,
        FOCUS_DURATION_MAX,
        CRIT_MELEE_DMG_MOD_MAX,
        FOCUS_CAST_PROC_NO_BYPASS,
        ADD_EXTRA_PRIMARY_ATTACK_PCT,
        ADD_EXTRA_SECONDARY_ATTACK_PCT,
        FOCUS_CAST_TIME_MOD2,
        FOCUS_CAST_TIME_AMT,
        FEARSTUN,
        MELEE_DMG_POSITION_MOD,
        MELEE_DMG_POSITION_AMT,
        DMG_TAKEN_POSITION_MOD,
        DMG_TAKEN_POSITION_AMT,
        AMPLIFY_MOD,
        AMPLIFY_AMT,
        HEALTH_TRANSFER,
        FOCUS_RESIST_INCOMING,
        FOCUS_TIMER_MIN,
        PROC_TIMER_MOD,
        MANA_MAX,
        ENDURANCE_MAX,
        AC_AVOIDANCE_MAX,
        AC_MITIGATION_MAX,
        ATTACK_OFFENSE_MAX,
        ATTACK_ACCURACY_MAX,
        LUCK_AMT,
        LUCK_PCT,
        ENDURANCE_ABSORB_PCT_DMG,
        INSTANT_MANA_PCT,
        INSTANT_ENDURANCE_PCT,
        DURATION_HP_PCT,
        DURATION_MANA_PCT,
        DURATION_ENDURANCE_PCT,
        UNKNOWN = uint.MaxValue
    }

    /// <summary>
    /// https://www.redguides.com/wiki/Spell_categories
    /// </summary>
    public enum SpellCategory : uint
    {
        AEGOLISM = 1u,
        AGILITY,
        ALLIANCE,
        ANIMAL,
        ANTONICA,
        ARMOR_CLASS,
        ATTACK,
        BANE,
        BLIND,
        BLOCK,
        CALM,
        CHARISMA,
        CHARM,
        COLD,
        COMBAT_ABILITIES,
        COMBAT_INNATES,
        CONVERSIONS,
        CREATE_ITEM,
        CURE,
        DAMAGE_OVER_TIME,
        DAMAGE_SHIELD,
        DEFENSIVE,
        DESTROY,
        DEXTERITY,
        DIRECT_DAMAGE,
        DISARM_TRAPS,
        DISCIPLINES,
        DISCORD,
        DISEASE,
        DISEMPOWERING,
        DISPEL,
        DURATION_HEALS,
        DURATION_TAP,
        ENCHANT_METAL,
        ENTHRALL,
        FAYDWER,
        FEAR,
        FIRE,
        FIZZLE_RATE,
        FUMBLE,
        HASTE,
        HEALS,
        HEALTH,
        HEALTH_MANA,
        HP_BUFFS,
        HP_TYPE_ONE,
        HP_TYPE_TWO,
        ILLUSION_OTHER,
        ILLUSION_ADVENTURER,
        IMBUE_GEM,
        INVISIBILITY,
        INVULNERABILITY,
        JOLT,
        KUNARK,
        LEVITATE,
        LIFE_FLOW,
        LUCLIN,
        MAGIC,
        MANA,
        MANA_DRAIN,
        MANA_FLOW,
        MELEE_GUARD,
        MEMORY_BLUR,
        MISC,
        MOVEMENT,
        OBJECTS,
        ODUS,
        OFFENSIVE,
        PET,
        PET_HASTE,
        PET_MISC_BUFFS,
        PHYSICAL,
        PICKLOCK,
        PLANT,
        POISON,
        POWER_TAP,
        QUICK_HEAL,
        REFLECTION,
        REGEN,
        RESIST_BUFF,
        RESIST_DEBUFFS,
        RESURRECTION,
        ROOT,
        RUNE,
        SENSE_TRAP,
        SHADOWSTEP,
        SHIELDING,
        SLOW,
        SNARE,
        SPECIAL,
        SPELL_FOCUS,
        SPELL_GUARD,
        SPELLSHIELD,
        STAMINA,
        STATISTIC_BUFFS,
        STRENGTH,
        STUN,
        SUM_AIR,
        SUM_ANIMATION,
        SUM_EARTH,
        SUM_FAMILIAR,
        SUM_FIRE,
        SUM_UNDEAD,
        SUM_WARDER,
        SUM_WATER,
        SUMMON_ARMOR,
        SUMMON_FOCUS,
        SUMMON_FOOD_WATER,
        SUMMON_UTILITY,
        SUMMON_WEAPON,
        SUMMONED,
        SYMBOL,
        TAELOSIA,
        TAPS,
        TECHNIQUES,
        THE_PLANES,
        TIMER_1,
        TIMER_2,
        TIMER_3,
        TIMER_4,
        TIMER_5,
        TIMER_6,
        TRANSPORT,
        UNDEAD,
        UTILITY_BENEFICIAL,
        UTILITY_DETRIMENTAL,
        VELIOUS,
        VISAGES,
        VISION,
        WISDOM_INTELLIGENCE,
        TRAPS,
        AURAS,
        ENDURANCE,
        SERPENTS_SPINE,
        CORRUPTION,
        LEARNING,
        CHROMATIC,
        PRISMATIC,
        SUM_SWARM,
        DELAYED,
        TEMPORARY,
        TWINCAST,
        SUM_BODYGUARD,
        HUMANOID,
        HASTE_SPELL_FOCUS,
        TIMER_7,
        TIMER_8,
        TIMER_9,
        TIMER_10,
        TIMER_11,
        TIMER_12,
        HATRED,
        FAST,
        ILLUSION_SPECIAL,
        TIMER_13,
        TIMER_14,
        TIMER_15,
        TIMER_16,
        TIMER_17,
        TIMER_18,
        TIMER_19,
        TIMER_20,
        ALARIS,
        COMBINATION,
        INDEPENDENT,
        SKILL_ATTACKS,
        INCOMING,
        CURSE,
        TIMER_21,
        TIMER_22,
        TIMER_23,
        TIMER_24,
        TIMER_25,
        DRUNKENNESS,
        THROWING,
        MELEE_DAMAGE,
        UNKNOWN = uint.MaxValue
    }

    public readonly struct ReagentInfo
    {
        public uint ItemID { get; }
        public uint RequiredCount { get; }

        public ReagentInfo(uint itemID, uint count)
        {
            ItemID = itemID;
            RequiredCount = count;
        }
    }

    public static class SpellTypeExtensions
    {
        public static readonly SpellCategory[] BuffSpellCategories = new SpellCategory[]
        {
            SpellCategory.AEGOLISM,
            SpellCategory.AGILITY,
            SpellCategory.ARMOR_CLASS,
            SpellCategory.ATTACK,
            SpellCategory.CHARISMA,
            SpellCategory.DAMAGE_SHIELD,
            SpellCategory.DEFENSIVE,
            SpellCategory.DEXTERITY,
            SpellCategory.ENDURANCE,
            SpellCategory.FAST,
            SpellCategory.HASTE,
            SpellCategory.HASTE_SPELL_FOCUS,
            SpellCategory.HEALTH,
            SpellCategory.HEALTH_MANA,
            SpellCategory.HP_BUFFS,
            SpellCategory.HP_TYPE_ONE,
            SpellCategory.HP_TYPE_TWO,
            SpellCategory.LEVITATE,
            SpellCategory.MANA,
            SpellCategory.MANA_FLOW,
            SpellCategory.MOVEMENT,
            SpellCategory.REGEN,
            SpellCategory.RESIST_BUFF,
            SpellCategory.RUNE,
            SpellCategory.SHIELDING,
            SpellCategory.SPELLSHIELD,
            SpellCategory.SPELL_FOCUS,
            SpellCategory.SPELL_GUARD,
            SpellCategory.STAMINA,
            SpellCategory.STATISTIC_BUFFS,
            SpellCategory.STRENGTH,
            SpellCategory.SYMBOL,
            //SpellCategory.UTILITY_BENEFICIAL,
            //SpellCategory.VISION,
            SpellCategory.WISDOM_INTELLIGENCE
        };

        public static bool IsBuff(this SpellType @this)
        {
            return @this.Beneficial && BuffSpellCategories.Contains(@this.GetSpellCategory());
        }

        public static SpellCategory GetSpellCategory(this SpellType @this)
        {
            return (SpellCategory)@this.CategoryID.GetValueOrDefault(uint.MaxValue);
        }

        public static IEnumerable<ReagentInfo> GetReagents(this SpellType @this)
        {
            for (int i = 1; i <= 4; i++)
            {
                var itemID = @this.GetReagentID(i).GetValueOrDefault(0u);

                if (itemID > 0u && itemID < uint.MaxValue)
                {
                    var count = @this.GetReagentCount(i).GetValueOrDefault(0u);

                    yield return new ReagentInfo(itemID, count);
                }
                else
                {
                    itemID = @this.GetNoExpendReagentID(i).GetValueOrDefault(0u);

                    if (itemID > 0u && itemID < uint.MaxValue)
                    {
                        var count = @this.GetReagentCount(i).GetValueOrDefault(0u);

                        yield return new ReagentInfo(itemID, count);
                    }
                }
            }
        }

        public static bool HasCastTime(this SpellType @this)
        {
            return @this.CastTime.HasValue ?
                @this.CastTime.Value > TimeSpan.Zero :
                false;
        }
    }
}
